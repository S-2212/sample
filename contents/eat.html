<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<link rel="icon" type="imge/png" href="../favicon/favicon.png">
	<title>食べ物</title>
	<link rel="stylesheet" href="../styles/style2.css">
</head>

<body>
	<div class="container container_eat">
		<div class="box1">
			<img class="list_img" src='../images/niku.png' alt='肉アイコン'>
			<p class="eat">肉料理</p>
		</div>
		<div class="box1">
			<img class="list_img" src='../images/cafe.png' alt='カフェアイコン'>
			<p class="eat">カフェ</p>
		</div>
		<div class="box1">
			<img class="list_img" src='../images/fish.png' alt='魚アイコン'>
			<p class="eat">魚料理</p>
		</div>

	</div>

	<div class="push">
		<a id="push" href=" ">
			<button class="push_button" type="button">
				<ランダムでページを表示><br>push
			</button>
		</a>
	</div>
	<div class="button">
		<button class="back_button" type="button" onclick="history.back()">戻る</button>
	</div>

	<script type="text/javascript">
		//URLを配列に格納
		const foods = [
			'eat_next/sushi.html',
			'eat_next/neji.html',
			'eat_next/niku.html',
			'eat_next/udon.html'
		];

		if (foods.length >= 2) {
			//ウェブブラウザ上でpageshowイベント発生時（通常のロード時もブラウザバック時も）に、
			//event.persistedでtrue（キャッシュから復元）、それ以外はfalseを返す
			window.addEventListener('pageshow', function (event) {
				if (event.persisted) {
					//以下ブラウザバックでのページロード時の動作（２回目以降）

					//sessionStorageの値を取得し、数値に変換
					let oldValue = sessionStorage.getItem('oldValue');
					let oldNumber = parseInt(oldValue, 10);

					//0~配列のデータ総数の範囲で前回と異なる数字になるまで乱数を生成
					do {
						var newNumber = Math.floor(Math.random() * foods.length);
					} while (newNumber === oldNumber);

					//一致するIDの要素を取得し、更新
					const link1 = document.getElementById('push');
					link1.setAttribute('href', foods[newNumber]);

					//値を更新
					oldNumber = newNumber;

					// 新しい値をsessionStorageに保存
					sessionStorage.setItem('oldValue', oldNumber);
				} else {
					//以下通常のページロード時の動作（初回表示時のみ）
					let oldValue = sessionStorage.getItem('oldValue');

					if (oldValue === null) {
						const link1 = document.getElementById('push');
						link1.setAttribute('href', foods[0]);
						sessionStorage.setItem('oldValue', 0);
					} else {
						let oldNumber = parseInt(oldValue, 10);

						//0~配列のデータ総数の範囲で前回と異なる数字になるまで乱数を生成
						do {
							var newNumber = Math.floor(Math.random() * foods.length);
						} while (newNumber === oldNumber);

						//一致するIDの要素を取得し、更新
						const link1 = document.getElementById('push');
						link1.setAttribute('href', foods[newNumber]);

						//値を更新
						oldNumber = newNumber;

						// 新しい値をsessionStorageに保存
						sessionStorage.setItem('oldValue', oldNumber);
					}
				}
			});
		} else {
			const link1 = document.getElementById('push');
			link1.setAttribute('href', foods[0]);
		}

	</script>

</body>

</html>