<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>お土産</title>
	<link rel="stylesheet" href="../styles/style2.css">
</head>

<body>
	<div class="container container_buy">
		<div class="box1">
			<img class="buy" src='../images/souvenir.png' alt='お土産アイコン'>
			<p class="omiyage">お土産</p>
				<p id="output"></p>
		</div>
	</div>
	
	<div class="push">
	<a id="push">
	<button class="push_button" type="button">push</button>
	</a>
	</div>
	<div class="button">
	<button class="back_button" type="button" onclick="history.back()">戻る</button>
	</div>
	
	<script type="text/javascript">
		const souvenirs = [
			'buy_next/neji.html',
			'buy_next/niku.html'
		];

	window.addEventListener('pageshow', function(event) {
	if (event.persisted) {
		console.log('ページがキャッシュから復帰しました。スクリプトを再実行します。');
		//sessionStorageの値を取得し、数値に変換
		let oldValue = sessionStorage.getItem('oldValue');
		let oldNumber = parseInt(oldValue, 10);

		//0~配列のデータ総数の範囲で前回と異なる数字になるまで乱数を生成
		do {
			var newNumber = Math.floor(Math.random() * souvenirs.length);
		} while (newNumber === oldNumber);

		//一致するIDの要素を取得し、更新
		const link1 = document.getElementById('push');
		link1.setAttribute('href', souvenirs[newNumber]);

		//値を更新
		oldNumber = newNumber;
		
		// 新しい値をsessionStorageに保存
        sessionStorage.setItem('oldValue', oldNumber);
		document.getElementById('output').textContent = oldNumber;
	} else {
		console.log('通常のページロードです。');
		let oldValue = sessionStorage.getItem('oldValue');
		let oldNumber = parseInt(oldValue, 10);

		//0~配列のデータ総数の範囲で前回と異なる数字になるまで乱数を生成
		do {
			var newNumber = Math.floor(Math.random() * souvenirs.length);
		} while (newNumber === oldNumber);

		//一致するIDの要素を取得し、更新
		const link1 = document.getElementById('push');
		link1.setAttribute('href', souvenirs[newNumber]);

		//値を更新
		oldNumber = newNumber;
		
		// 新しい値をsessionStorageに保存
        sessionStorage.setItem('oldValue', oldNumber);
		document.getElementById('output').textContent = oldNumber;
	}

		


	});
	</script>

</body>

</html>